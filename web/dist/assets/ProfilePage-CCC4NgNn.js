import{c as y,u as N,r as u,j as a,S,b as A}from"./index-tHDgc07s.js";import{B as P}from"./Button-DTOqL5YY.js";import{L as c,I as x}from"./Label-BFO2ikUa.js";import{S as E}from"./Skeleton-BCHcvZdc.js";import{b as F,s as B,h as _}from"./alerts-D6uugUBg.js";import"./confirmAlert-BWqzQj7I.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],U=y("save",M);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],L=y("user",C);function H(){const{user:l,setUser:w}=N(),[r,o]=u.useState({nama:"",username:"",email:"",phone:"",password:""}),[e,t]=u.useState({}),[g,j]=u.useState(!1);u.useEffect(()=>{l&&o({nama:l.nama||"",username:l.username||"",email:l.email||"",phone:l.phone||"",password:""})},[l]);const v=async()=>{const s=(r.nama||"").trim(),i=(r.username||"").trim(),n=(r.email||"").trim(),f=(r.phone||"").trim(),h=r.password||"",m={};if(s||(m.nama="Nama lengkap wajib diisi"),i?/^[a-zA-Z0-9._]{3,30}$/.test(i)||(m.username="Username minimal 3 karakter, hanya huruf/angka/titik/garis bawah"):m.username="Username wajib diisi",n||(m.email="Email wajib diisi"),f||(m.phone="Nomor WhatsApp wajib diisi"),h&&h.length<6&&(m.password="Password minimal 6 karakter"),t(m),Object.keys(m).length>0){F("Lengkapi data","Periksa kembali input yang ditandai");return}const k={nama:s,email:n,phone:f,username:i};h&&(k.password=h);try{j(!0);const d=(await A.put("/users/profile",k)).data;w(d),localStorage.setItem("user",JSON.stringify(d)),o({...r,password:""}),t({}),B("Berhasil","Profil diperbarui")}catch(p){const d=p?.response?.data?.message||p?.message||"";d&&/password/i.test(d)&&/6|six/i.test(d)&&t(b=>({...b,password:"Password minimal 6 karakter"})),_(p,"Gagal menyimpan profil")}finally{j(!1)}};return l?a.jsxs("div",{className:"max-w-xl mx-auto p-6 sm:p-8 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-2xl shadow-md dark:shadow-lg space-y-6 animate-fade-in",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(L,{className:"w-6 h-6 text-blue-600"}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Profil Saya"}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Perbarui informasi akun Anda di sini."})]})]}),a.jsxs("form",{onSubmit:s=>{s.preventDefault(),v()},className:"space-y-5",children:[a.jsxs("div",{children:[a.jsxs(c,{htmlFor:"nama",children:["Nama Lengkap ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(x,{id:"nama",type:"text",placeholder:"Nama lengkap",value:r.nama,"aria-required":"true","aria-invalid":!!e.nama,"aria-describedby":e.nama?"nama-error":void 0,onBlur:()=>{r.nama||t(s=>({...s,nama:"Nama lengkap wajib diisi"}))},onChange:s=>{const i=s.target.value;o({...r,nama:i}),i&&t(n=>({...n,nama:void 0}))}}),e.nama&&a.jsx("p",{id:"nama-error",className:"mt-1 text-xs text-red-600",children:e.nama})]}),a.jsxs("div",{children:[a.jsxs(c,{htmlFor:"username",children:["Username ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(x,{id:"username",type:"text",placeholder:"Misal: bps.bulungan",value:r.username,"aria-required":"true","aria-invalid":!!e.username,"aria-describedby":e.username?"username-error":"username-help",autoComplete:"username",onBlur:()=>{const s=(r.username||"").trim();s?/^[a-zA-Z0-9._]{3,30}$/.test(s)||t(i=>({...i,username:"Username minimal 3 karakter, hanya huruf/angka/titik/garis bawah"})):t(i=>({...i,username:"Username wajib diisi"}))},onChange:s=>{const i=s.target.value;o({...r,username:i}),i&&/^[a-zA-Z0-9._]{3,30}$/.test(i)&&t(n=>({...n,username:void 0}))}}),!e.username&&a.jsx("p",{id:"username-help",className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Wajib. 3-30 karakter, huruf/angka, boleh titik atau _."}),e.username&&a.jsx("p",{id:"username-error",className:"mt-1 text-xs text-red-600",children:e.username})]}),a.jsxs("div",{children:[a.jsxs(c,{htmlFor:"email",children:["Email ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(x,{id:"email",type:"email",placeholder:"Alamat email aktif",value:r.email,"aria-required":"true","aria-invalid":!!e.email,"aria-describedby":e.email?"email-error":"email-help",onBlur:()=>{r.email||t(s=>({...s,email:"Email wajib diisi"}))},onChange:s=>{const i=s.target.value;o({...r,email:i}),i&&t(n=>({...n,email:void 0}))}}),!e.email&&a.jsx("p",{id:"email-help",className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Gunakan email yang valid dan aktif."}),e.email&&a.jsx("p",{id:"email-error",className:"mt-1 text-xs text-red-600",children:e.email})]}),a.jsxs("div",{children:[a.jsxs(c,{htmlFor:"phone",children:["Nomor WhatsApp ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(x,{id:"phone",type:"text",placeholder:"Nomor WhatsApp aktif",value:r.phone,"aria-required":"true","aria-invalid":!!e.phone,"aria-describedby":e.phone?"phone-error":"phone-help",onBlur:()=>{r.phone||t(s=>({...s,phone:"Nomor WhatsApp wajib diisi"}))},onChange:s=>{const i=s.target.value;o({...r,phone:i}),i&&t(n=>({...n,phone:void 0}))}}),!e.phone&&a.jsx("p",{id:"phone-help",className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Format: 62xxxxxxxxxx. Pastikan nomor dapat dihubungi."}),e.phone&&a.jsx("p",{id:"phone-error",className:"mt-1 text-xs text-red-600",children:e.phone})]}),a.jsxs("div",{children:[a.jsx(c,{htmlFor:"password",children:"Password Baru"}),a.jsx(x,{id:"password",type:"password",placeholder:"Opsional - isi jika ingin mengganti",value:r.password,"aria-invalid":!!e.password,"aria-describedby":e.password?"password-error":"password-help",onChange:s=>o({...r,password:s.target.value})}),!e.password&&a.jsx("p",{id:"password-help",className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Opsional. Kosongkan jika tidak ingin mengubah. Minimal 6 karakter."}),e.password&&a.jsx("p",{id:"password-error",className:"mt-1 text-xs text-red-600",children:e.password})]}),a.jsx("div",{className:"pt-2 flex sm:justify-end",children:a.jsx(P,{type:"submit",disabled:g,className:"w-full sm:w-auto flex items-center justify-center gap-2",children:g?a.jsxs(a.Fragment,{children:[a.jsx(S,{className:"w-4 h-4"}),"Menyimpan..."]}):a.jsxs(a.Fragment,{children:[a.jsx(U,{size:16}),"Simpan Perubahan"]})})})]})]}):a.jsx("div",{className:"p-6 text-center text-gray-500",children:a.jsx(E,{className:"mx-auto h-4 w-40"})})}export{H as default};
